<md-dialog aria-label="improve score" class="improve-score-modal">
    <form name="improveScoreForm" novalidate="" class="form-validate">
        <md-toolbar>
            <div class="md-toolbar-tools">
                <h2 class="text-dark">{{'dashboard.improveScoreModal.TITLE' | translate}}</h2>
                <span flex/>
                <md-button class="md-icon-button" ng-click="cancel()">
                    <md-icon md-svg-src="app/img/icons/ic_close_24px.svg" aria-label="Close dialog"/>
                </md-button>
            </div>
        </md-toolbar>
        <md-dialog-content>
            <div class="mv mh improve-score">
                <div id="summary" ng-if="view===STEP[0]" class="summary">
                    <div class="header clearfix">
                        <div class="score-gauge">
                            <ng-gauge size="125" type="arch" thick="12"
                                      min="0" max="100" value="summary.currScore.value"
                                      cap="round" label="{{summary.currScore.text}}" append="" foreground-color="F00"
                                      duration="1" thresholds="securityRiskThresholds" background-color="#EEE">
                            </ng-gauge>
                        </div>
                        <div class="description text-muted">
                            {{summary.description}}
                        </div>
                    </div>
                    <hr class="solid mt0"/>
                    <div class="instruction-content">
                        <div ng-repeat="scoreInstruction in summary.scoreInstructions track by $index">
                            <div class="brief">
                                <div class="col col-xs-9" ng-click="toggleAdvice(summary.scoreInstructions[$index].isOpen, $index)">
                                    <div ng-repeat="brief in scoreInstruction.brief">
                                        <strong >{{brief}}</strong>
                                    </div>
                                </div>
                                <div class="col col-xs-1">
                                    <i class="fa" aria-hidden="true"
                                       ng-class="{'fa-caret-up': summary.scoreInstructions[$index].isOpen, 'fa-caret-down': !summary.scoreInstructions[$index].isOpen}"
                                       ng-click="toggleAdvice(summary.scoreInstructions[$index].isOpen, $index)"></i>
                                </div>
                                <div class="col col-xs-2 text-right" ng-if="improvementEffected[0]">
                                    <span ng-if="!scoreInstruction.isCompleted" class="hand link" ng-click="goTo($index + 1)">
                                        {{scoreInstruction.action[0]}}>>
                                    </span>
                                    <span ng-if="scoreInstruction.isCompleted" class="text-success text-bold">
                                        {{scoreInstruction.action[1]}}
                                    </span>
                                </div>
                                <div style="clear: both;"></div>
                            </div>
                            <div class="advice mb clearfix" ng-show="summary.scoreInstructions[$index].isOpen">
                                <div ng-repeat="advice in scoreInstruction.advice" class="col col-xs-9 clearfix">
                                    {{advice}}
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="bottom-button">
                        <div class="col-sm-12 pb-sm">
                            <button class="btn btn-wide btn-default pull-right"
                                    ng-click="goFinish()" ng-if="improvementEffected[0]">
                                <em class="mr-sm"/>{{'dashboard.improveScoreModal.FINISH' | translate}}
                            </button>
                        </div>
                    </div>
                </div>

                <div id="serviceMode" ng-if="view===STEP[1]" class="service-mode">
                    <div class="header clearfix">
                        <div class="col col-xs-7 description text-muted">
                            {{serviceMode.description}}
                        </div>
                        <div class="col col-xs-5">
                            <div class="col col-xs-4 score-gauge text-center">
                                <ng-gauge size="100" type="arch" thick="12"
                                          min="0" max="100" value="serviceMode.currScore.value"
                                          cap="round" label="{{serviceMode.currScore.text}}" append="" foreground-color="F00"
                                          duration="1" thresholds="securityRiskThresholds" background-color="#EEE">
                                </ng-gauge>
                            </div>
                            <div class="col col-xs-4 text-center pt">
                                <div class="text-muted score-trend-text text-center">{{"dashboard.improveScoreModal.SCORE_TREND" | translate}}</div>
                                <div class="fa fa-long-arrow-right text-primary score-trend text-center" aria-hidden="true">
                                </div>
                            </div>
                            <div class="col col-xs-4 score-gauge text-center">
                                <ng-gauge size="100" type="arch" thick="12"
                                          min="0" max="100" value="serviceMode.futureScore.value"
                                          cap="round" label="{{serviceMode.futureScore.text}}" append="" foreground-color="F00"
                                          duration="1" thresholds="securityRiskThresholds" background-color="#EEE">
                                </ng-gauge>
                            </div>
                        </div>
                    </div>
                    <hr class="solid mb mt0"/>
                    <div ng-if="isGlobalUser" class="new-service-mode clearfix">
                        <div class="form-group">
                            <div class="pull-left mb" style="padding-top: 2px;">
                                <div class="text-gray-label">{{'setting.NEW_SERVICE' | translate | uppercase}}</div>
                            </div>
                            <div class="pull-left ml-lg">
                                <div>
                                    <div class="radio-inline c-radio mr-lg" ng-class="inputMaskDisabledClass">
                                        <label class="text-gray-label" ng-class="inputMaskDisabledClass">
                                            <input type="radio" name="mode" value="Discover" ng-model="currentNewServiceMode[0]" ng-click="switchNewServiceMode('Discover')"/>
                                            <span class="fa fa-binoculars text-discover" ng-class="inputMaskDisabledClass"/>{{'topbar.mode.LEARNING' | translate}}
                                        </label>
                                    </div>
                                    <div class="radio-inline c-radio pl-sm mr-lg" ng-class="inputMaskDisabledClass">
                                        <label class="text-gray-label" ng-class="inputMaskDisabledClass">
                                            <input type="radio" name="mode" value="Monitor" ng-model="currentNewServiceMode[0]" ng-click="switchNewServiceMode('Monitor')"/>
                                            <span class="fa fa-bell text-monitor" ng-class="inputMaskDisabledClass"/>{{'topbar.mode.EVALUATION' | translate}}
                                        </label>
                                    </div>
                                    <div class="radio-inline c-radio pl-sm" ng-class="inputMaskDisabledClass">
                                        <label class="text-gray-label" ng-class="inputMaskDisabledClass">
                                            <input type="radio" name="mode" value="Protect" ng-model="currentNewServiceMode[0]" ng-click="switchNewServiceMode('Protect')"/>
                                            <span class="fa fa-shield text-protect" ng-class="inputMaskDisabledClass"/>{{'topbar.mode.ENFORCE' | translate}}
                                        </label>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="existing-service-mode">
                        <div>
                            <div class="clearfix">
                                <div class="left-inner-addon pull-right ">
                                    <em class="fa fa-filter text-filter"></em>
                                    <input class="search form-control" placeholder="{{'general.FILTER' | translate}}" type="text"
                                           maxlength="{{'general.FILTER_MAX_LEN' | translate}}"
                                           ng-model="search"
                                           ng-paste="onFilterChanged(search)"
                                           ng-keyup="onFilterChanged(search)"/>
                                </div>
                                <div class="pull-left mr-lg" ng-show="!servicesErr && hasSelectedService[0]">
                                    <div ng-if="isAllProtectMode[0]" class="text-success">{{'dashboard.improveScoreModal.ALL_PROTECT_MODE_DECLARE' | translate}}</div>
                                    <div ng-if="!isAllProtectMode[0]" uib-dropdown dropdown-append-to-body class="mt-sm">
                                        <div uib-dropdown-toggle>
                                            <div>
                                                <label class="text-gray-label">{{'service.SWITCH_MODE' | translate}}</label>
                                                <em class="fa fa-caret-down text-action" ng-click="toggleCollapse()"/>
                                            </div>
                                        </div>
                                        <ul class="dropdown-menu" uib-dropdown-menu role="menu" aria-labelledby="single-button">
                                            <li role="menuitem">
                                                <a ng-click="switchServiceMode('Discover', false)">
                                                    <em class="fa fa-binoculars fa-fw text-discover mr-sm"/>{{'enum.DISCOVER' | translate}}
                                                </a>
                                            </li>
                                            <li role="menuitem">
                                                <a ng-click="switchServiceMode('Monitor', false)">
                                                    <em class="fa fa-bell fa-fw text-monitor mr-sm"/>{{'enum.MONITOR' | translate}}
                                                </a>
                                            </li>
                                            <li class="menuitem">
                                                <a type="button" ng-click="switchServiceMode('Protect', false)">
                                                    <em class="fa fa-shield fa-fw text-protect mr-sm"/>{{'enum.PROTECT' | translate}}
                                                </a>
                                            </li>
                                        </ul>
                                    </div>
                                </div>
                                <div style="height: 42px;">
                                  <div class="pull-left" style="margin-left: 12px; margin-top: 2px;" ng-show="!servicesErr && hasSelectedService[0]">
                                    <label class="text-gray-label pull-left mr mt-sm">{{ 'group.BASELINE_PROFILE' | translate | uppercase }}</label>
                                    <md-radio-group ng-if="hasSelectedService[0]" ng-model="baselineProfile" ng-change="toggleBaselineProfile(baselineProfile, false)">
                                      <md-radio-button class="pull-left mr-lg" style="margin-top: 2px;" value="basic" class="md-primary">{{'group.BASIC' | translate}}</md-radio-button>
                                      <md-radio-button class="pull-left" style="margin-top: 2px;" value="zero-drift" class="md-primary">{{'group.ZERO_DRIFT' | translate}}</md-radio-button>
                                    </md-radio-group>
                                  </div>
                                </div>
                            </div>
                            <div ag-grid="gridService" class="ag-grid" style="width: 100%; margin-top: 10px"
                                 ng-style="{ height: serviceGridHeight + 'px'}" ></div>
                        </div>
                        <div class="mb0" ng-if="hasService">
                            <div>
                                <md-tabs md-no-ink md-dynamic-height="" md-border-bottom
                                         md-selected="selectedIndex" class="ph0">
                                    <md-tab label="{{'service.PROCESS_PROFILE' | translate}}" ng-click="getProcessProfile(service.name, selectedIndex)">
                                        <md-content class="pb0">
                                            <div class="mt-sm mb0">
                                                <div ag-grid="gridProfile" class="ag-grid" style="width: 100%;"
                                                     ng-style="{ height: ruleGridHeight + 'px'}">
                                                </div>
                                            </div>
                                        </md-content>
                                    </md-tab>
                                    <md-tab label="{{'service.FILE_PROFILE' | translate}}" ng-click="getFileProfile(service.name, selectedIndex)" ng-if="serviceKind==='container'">
                                        <md-content class="pb0">
                                            <div class="mt-sm mb0">
                                                <div ag-grid="gridFile" class="ag-grid" style="width: 100%;"
                                                     ng-style="{ height: ruleGridHeight + 'px'}">
                                                </div>
                                            </div>
                                        </md-content>
                                    </md-tab>
                                    <md-tab label="{{'service.POLICY_RULES' | translate}}" ng-click="getServiceRules(service.name, selectedIndex)">
                                        <md-content class="pb0">
                                            <div class="mt-sm mb0">
                                                <div ag-grid="gridRules" class="ag-grid" style="width: 100%;"
                                                     ng-style="{ height: ruleGridHeight + 'px'}">
                                                </div>
                                            </div>
                                        </md-content>
                                    </md-tab>
                                </md-tabs>
                            </div>
                        </div>
                    </div>
                    <div class="bottom-button">
                        <div class="col-sm-12 pb-sm">
                            <button class="btn btn-wide btn-default pull-right"
                                    ng-click="backToSummary(true)" ng-disabled="isSwitchingMode[0]">
                                <em class="mr-sm"/>{{'dashboard.improveScoreModal.DONE' | translate}}
                            </button>
                        </div>
                    </div>
                </div>

                <div id="exposure" ng-if="view===STEP[2]" class="exposure">
                    <div class="header clearfix">
                        <div class="col col-xs-7 description text-muted">
                            {{exposure.description[progress]}}
                        </div>
                        <div class="col col-xs-5">
                            <div class="col col-xs-4 score-gauge text-center">
                                <ng-gauge size="100" type="arch" thick="12"
                                          min="0" max="100" value="exposure.currScore.value"
                                          cap="round" label="{{exposure.currScore.text}}" append="" foreground-color="F00"
                                          duration="1" thresholds="securityRiskThresholds" background-color="#EEE">
                                </ng-gauge>
                            </div>
                            <div class="col col-xs-4 text-center pt">
                                <div class="text-muted score-trend-text text-center">{{"dashboard.improveScoreModal.SCORE_TREND" | translate}}</div>
                                <div class="fa fa-long-arrow-right text-primary score-trend text-center" aria-hidden="true">
                                </div>
                            </div>
                            <div class="col col-xs-4 score-gauge text-center">
                                <ng-gauge size="100" type="arch" thick="12"
                                          min="0" max="100" value="exposure.futureScore.value"
                                          cap="round" label="{{exposure.futureScore.text}}" append="" foreground-color="F00"
                                          duration="1" thresholds="securityRiskThresholds" background-color="#EEE">
                                </ng-gauge>
                            </div>
                        </div>
                    </div>
                    <hr class="solid mb mt0"/>
                    <div class="exposure-progress">
                        <div class="row m0 ">
                            <div class="col col-xs-3 text-primary p0"  ng-repeat="progressName in exposure.progressNames track by $index">
                                <div class="progress-name" ng-class="{'curr-progress-text': progress>=$index, 'future-progress-text': progress<$index}">{{progressName}}</div>
                                <div class="nv-progress-bar" ng-class="{'curr-progress': progress>=$index, 'future-progress': progress<$index}"></div>
                            </div>
                        </div>
                    </div>
                    <div ng-if="progress===0">
                        <div class="existing-service-mode mt">
                            <div>
                                <div class="clearfix">
                                    <div class="left-inner-addon pull-right ">
                                        <em class="fa fa-filter text-filter"></em>
                                        <input class="search form-control" placeholder="{{'general.FILTER' | translate}}" type="text"
                                               maxlength="{{'general.FILTER_MAX_LEN' | translate}}"
                                               ng-model="search"
                                               ng-paste="onFilterChanged(search)"
                                               ng-keyup="onFilterChanged(search)"/>
                                    </div>
                                    <div class="pull-left mr-lg" ng-show="!servicesErr && hasSelectedService[0]">
                                        <div ng-if="isAllProtectMode[0]" class="text-success">{{'dashboard.improveScoreModal.ALL_PROTECT_MODE_DECLARE' | translate}}</div>
                                        <div ng-if="!isAllProtectMode[0]" uib-dropdown dropdown-append-to-body class="mt-sm">
                                            <div uib-dropdown-toggle>
                                                <div>
                                                    <label class="text-gray-label">{{'service.SWITCH_MODE' | translate}}</label>
                                                    <em class="fa fa-caret-down text-action" ng-click="toggleCollapse()"/>
                                                </div>
                                            </div>
                                            <ul class="dropdown-menu" uib-dropdown-menu role="menu" aria-labelledby="single-button">
                                                <li role="menuitem">
                                                    <a ng-click="switchServiceMode('Discover', true)">
                                                        <em class="fa fa-binoculars fa-fw text-discover mr-sm"/>{{'enum.DISCOVER' | translate}}
                                                    </a>
                                                </li>
                                                <li role="menuitem">
                                                    <a ng-click="switchServiceMode('Monitor', true)">
                                                        <em class="fa fa-bell fa-fw text-monitor mr-sm"/>{{'enum.MONITOR' | translate}}
                                                    </a>
                                                </li>
                                                <li class="menuitem">
                                                    <a type="button" ng-click="switchServiceMode('Protect', true)">
                                                        <em class="fa fa-shield fa-fw text-protect mr-sm"/>{{'enum.PROTECT' | translate}}
                                                    </a>
                                                </li>
                                            </ul>
                                        </div>
                                    </div>
                                    <div style="height: 42px;">
                                      <div class="pull-left" style="margin-left: 12px; margin-top: 2px;" ng-show="!servicesErr && hasSelectedService[0]">
                                        <label class="text-gray-label pull-left mr mt-sm">{{ 'group.BASELINE_PROFILE' | translate | uppercase }}</label>
                                        <md-radio-group ng-if="hasSelectedService[0]" ng-model="baselineProfile" ng-change="toggleBaselineProfile(baselineProfile, true)">
                                          <md-radio-button class="pull-left mr-lg" style="margin-top: 2px;" value="basic" class="md-primary">{{'group.BASIC' | translate}}</md-radio-button>
                                          <md-radio-button class="pull-left" style="margin-top: 2px;" value="zero-drift" class="md-primary">{{'group.ZERO_DRIFT' | translate}}</md-radio-button>
                                        </md-radio-group>
                                      </div>
                                    </div>
                                </div>
                                <div ag-grid="gridService" class="ag-grid" style="width: 100%; margin-top: 10px"
                                     ng-style="{ height: serviceGridHeight + 'px'}" ></div>
                            </div>
                            <div class="mb0" ng-if="hasService">
                                <div>
                                    <md-tabs md-no-ink md-dynamic-height="" md-border-bottom
                                             md-selected="selectedIndex" class="ph0">
                                        <md-tab label="{{'service.PROCESS_PROFILE' | translate}}" ng-click="getProcessProfile(service.name, selectedIndex)">
                                            <md-content class="pb0">
                                                <div class="mt-sm mb0">
                                                    <div ag-grid="gridProfile" class="ag-grid" style="width: 100%;"
                                                         ng-style="{ height: ruleGridHeight + 'px'}">
                                                    </div>
                                                </div>
                                            </md-content>
                                        </md-tab>
                                        <md-tab label="{{'service.FILE_PROFILE' | translate}}" ng-click="getFileProfile(service.name, selectedIndex)">
                                            <md-content class="pb0">
                                                <div class="mt-sm mb0">
                                                    <div ag-grid="gridFile" class="ag-grid" style="width: 100%;"
                                                         ng-style="{ height: ruleGridHeight + 'px'}">
                                                    </div>
                                                </div>
                                            </md-content>
                                        </md-tab>
                                        <md-tab label="{{'service.POLICY_RULES' | translate}}" ng-click="getServiceRules(service.name, selectedIndex)">
                                            <md-content class="pb0">
                                                <div class="mt-sm mb0">
                                                    <div ag-grid="gridRules" class="ag-grid" style="width: 100%;"
                                                         ng-style="{ height: ruleGridHeight + 'px'}">
                                                    </div>
                                                </div>
                                            </md-content>
                                        </md-tab>
                                    </md-tabs>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div ng-if="progress===1">
                        <div class="exposure-conversation">
                            <md-tabs md-no-ink md-dynamic-height="" md-border-bottom md-selected="selectedIndex4Exposure.threat"
                                     class="ph0 pb0">
                                <md-tab label="{{'dashboard.body.panel_title.INGRESS' | translate}}">
                                    <div ag-grid="gridIngressContainer" class="ag-grid" style="width: 100%; margin-top: 10px; height: 245px"></div>
                                </md-tab>
                                <md-tab label="{{'dashboard.body.panel_title.EGRESS' | translate}}">
                                    <div ag-grid="gridEgressContainer" class="ag-grid" style="width: 100%; margin-top: 10px; height: 245px"></div>
                                </md-tab>
                            </md-tabs>
                        </div>
                    </div>
                    <div ng-if="progress===2">
                        <div class="exposure-conversation">
                            <md-tabs md-no-ink md-dynamic-height="" md-border-bottom md-selected="selectedIndex4Exposure.violation"
                                     class="ph0 pb0">
                                <md-tab label="{{'dashboard.body.panel_title.INGRESS' | translate}}">
                                    <div ag-grid="gridIngressContainer" class="ag-grid" style="width: 100%; margin-top: 10px; height: 245px"></div>
                                </md-tab>
                                <md-tab label="{{'dashboard.body.panel_title.EGRESS' | translate}}">
                                    <div ag-grid="gridEgressContainer" class="ag-grid" style="width: 100%; margin-top: 10px; height: 245px"></div>
                                </md-tab>
                            </md-tabs>
                        </div>
                    </div>
                    <div ng-if="progress===3">
                        <div class="exposure-conversation">
                            <md-tabs md-no-ink md-dynamic-height="" md-border-bottom md-selected="selectedIndex4Exposure.normal"
                                     class="ph0 pb0">
                                <md-tab label="{{'dashboard.body.panel_title.INGRESS' | translate}}">
                                    <div ag-grid="gridIngressContainer" class="ag-grid" style="width: 100%; margin-top: 10px; height: 245px"></div>
                                </md-tab>
                                <md-tab label="{{'dashboard.body.panel_title.EGRESS' | translate}}">
                                    <div ag-grid="gridEgressContainer" class="ag-grid" style="width: 100%; margin-top: 10px; height: 245px"></div>
                                </md-tab>
                            </md-tabs>
                        </div>
                    </div>
                    <div class="bottom-button" ng-if="progress<3">
                        <div class="col-sm-12 pb-sm">
                            <button class="btn btn-wide btn-default pull-right"
                                    ng-click="toNext()">
                                <em class="mr-sm"/>{{'dashboard.improveScoreModal.NEXT' | translate}}
                            </button>
                            <button class="btn btn-wide btn-default pull-right mr"
                                    ng-click="backToSummary(true)">
                                <em class="mr-sm"/>{{'dashboard.improveScoreModal.DONE' | translate}}
                            </button>
                        </div>
                    </div>
                    <div class="bottom-button" ng-if="progress===3">
                        <div class="col-sm-12 pb-sm">
                            <button class="btn btn-wide btn-default pull-right"
                                    ng-click="backToSummary(true)">
                                <em class="mr-sm"/>{{'dashboard.improveScoreModal.DONE' | translate}}
                            </button>
                        </div>
                    </div>
                </div>

                <div id="privilege" ng-if="view===STEP[3]" class="privilege">
                    <div class="header clearfix">
                        <div class="col col-xs-7 description text-muted">
                            {{privilege.description}}
                        </div>
                        <div class="col col-xs-5">
                            <div class="col col-xs-4 score-gauge text-center">
                                <ng-gauge size="100" type="arch" thick="12"
                                          min="0" max="100" value="privilege.currScore.value"
                                          cap="round" label="{{privilege.currScore.text}}" append="" foreground-color="F00"
                                          duration="1" thresholds="securityRiskThresholds" background-color="#EEE">
                                </ng-gauge>
                            </div>
                            <div class="col col-xs-4 text-center pt">
                                <div class="text-muted score-trend-text text-center">{{"dashboard.improveScoreModal.SCORE_TREND" | translate}}</div>
                                <div class="fa fa-long-arrow-right text-primary score-trend text-center" aria-hidden="true">
                                </div>
                            </div>
                            <div class="col col-xs-4 score-gauge text-center">
                                <ng-gauge size="100" type="arch" thick="12"
                                          min="0" max="100" value="privilege.futureScore.value"
                                          cap="round" label="{{privilege.futureScore.text}}" append="" foreground-color="F00"
                                          duration="1" thresholds="securityRiskThresholds" background-color="#EEE">
                                </ng-gauge>
                            </div>
                        </div>
                    </div>
                    <hr class="solid mb mt0"/>
                    <div class="clearfix">
                        <div class="left-inner-addon pull-right" style="margin-bottom: 10px">
                            <em class="fa fa-filter text-filter"/>
                            <input class="search form-control" placeholder="{{'general.FILTER' | translate}}"
                                   type="text"
                                   maxlength="{{'general.FILTER_MAX_LEN' | translate}}"
                                   ng-model="search"
                                   ng-paste="onFilterChanged(search)"
                                   ng-keyup="onFilterChanged(search)"/>
                        </div>
                        <div
                          class="pull-right mr mt-sm"
                          ng-click="exportPrivilegeCsv()"
                          ng-if="hasWorkloads"
                        >
                          <em class="fa fa-download text-action"></em>
                          <label class="text-gray-label hand">
                            {{'general.CSV_DOWNLOAD' | translate}}
                          </label>
                        </div>
                    </div>
                    <div ag-grid="gridOptions" class="ag-grid" style="width: 100%; height: 180px;">
                    </div>
                    <div ng-if="hasWorkloads">
                        <div class="mv-sm"><strong>{{'dashboard.improveScoreModal.DETAILS' | translate}}</strong></div>
                        <div class="container-details">
                            <div class="row m0">
                                <div class="col-xs-6 auto-hide " uib-tooltip="{{workload.id}}" tooltip-enable="false" show-tooltip-on-text-overflow>
                                    <strong>{{'controllers.detail.ID' | translate}}:</strong> {{workload.id}}
                                </div>
                                <div class="col-xs-6 auto-hide " uib-tooltip="{{workload.host_name}}" tooltip-enable="false" show-tooltip-on-text-overflow>
                                    <strong>{{'containers.detail.HOST_NAME' | translate}}:</strong> {{workload.host_name}}
                                </div>
                            </div>
                            <div class="row m0">
                                <div class="col-xs-6 auto-hide " uib-tooltip="{{workload.service}}" tooltip-enable="false" show-tooltip-on-text-overflow>
                                    <strong>{{'network.gridHeader.SERVICE' | translate}}:</strong> {{workload.service}}
                                </div>
                                <div class="col-xs-6 auto-hide " uib-tooltip="{{workload.network_mode}}" tooltip-enable="false" show-tooltip-on-text-overflow>
                                    <strong>{{'containers.detail.NETWORK_MODE' | translate}}:</strong> {{workload.network_mode}}
                                </div>
                            </div>
                            <div class="row m0">
                                <div class="col-xs-6 auto-hide " uib-tooltip=" {{workload.image}}" tooltip-enable="false" show-tooltip-on-text-overflow>
                                    <strong>{{'containers.detail.IMAGE' | translate}}:</strong> {{workload.image}}
                                </div>
                                <div class="col-xs-6 auto-hide " uib-tooltip="{{workload.privileged}}" tooltip-enable="false" show-tooltip-on-text-overflow>
                                    <strong>{{'containers.detail.ROOT_PRIVILEGED' | translate}}:</strong> {{workload.privileged}}
                                </div>
                            </div>
                            <div class="row m0">
                                <div class="col-xs-6 auto-hide " uib-tooltip="{{workload.enforcer_name}}" tooltip-enable="false" show-tooltip-on-text-overflow>
                                    <strong>{{'containers.detail.ENFORCER' | translate}}:</strong> {{workload.enforcer_name}}
                                </div>
                                <div class="col-xs-6 auto-hide " ng-if="workload.finished_at" uib-tooltip="{{workload.finished_at | date:'MMM dd, y HH:mm:ss'}}" tooltip-enable="false" show-tooltip-on-text-overflow>
                                    <strong>{{'enforcers.detail.DISCONNECTED_AT' | translate}}:</strong> {{workload.finished_at | date:'MMM dd, y HH:mm:ss'}}
                                </div>
                            </div>
                            <hr class="dashed mv-sm" ng-if="isNotEmptyObj(workload.interfaces) || (workload.ports && workload.ports.length>0)"/>
                            <div ng-if="isNotEmptyObj(workload.interfaces)">
                                <div style="padding-left:15px; padding-right: 15px;">
                                    <strong>{{'containers.detail.NETWORK_INTERFACES' | translate}}</strong>
                                </div>
                                <div class="row" ng-repeat="(name, nets) in workload.interfaces">
                                    <div class="col-sm-2 text-right">
                                        <strong>{{name}}</strong>
                                    </div>
                                    <div class="col-sm-1"></div>
                                    <div class="col-sm-9">
                                        <div ng-repeat="net in nets" class="text-muted">
                                            <div class="col-sm-4">
                                                IP:{{net.ip}}/{{net.ip_prefix}}
                                            </div>
                                            <div class="col-sm-8">
                                                {{"general.GATEWAY" | translate}}:{{net.gateway}}
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div ng-if="workload.ports && workload.ports.length>0">
                                <div style="padding-left:15px; padding-right: 15px;">
                                    <strong>{{'containers.detail.PORT_MAPPING' | translate}}</strong>
                                </div>
                                <div class="row m0" ng-repeat="mapping in workload.ports">
                                    <div class="col-sm-2 text-right">
                                        {{mapping.host_ip}}/{{mapping.host_port}}
                                    </div>
                                    <div class="col-sm-1 text-center">
                                        <em class="fa fa-long-arrow-right text-primary fa-lg"/>
                                    </div>
                                    <div class="col-sm-9 text-muted">
                                        {{mapping.ip_proto === 6 ? 'TCP' : 'UDP'}}/{{mapping.port}}
                                    </div>
                                </div>
                            </div>
                            <div ng-if="isNotEmptyObj(workload.labels)">
                                <div style="padding-left:15px; padding-right: 15px;">
                                    <strong>{{'containers.detail.LABELS' | translate}}</strong>
                                </div>
                                <div class="table-row" ng-repeat="(label, value) in workload.labels">
                                    <div class="row m0">
                                        <div class="col-sm-4 text-right auto-hide"
                                             uib-tooltip="{{label}}" tooltip-enable="false"
                                             show-tooltip-on-text-overflow>
                                            {{label}}
                                        </div>
                                        <div class="col-sm-8 text-muted">
                                            {{value || "&nbsp;"}}
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="bottom-button">
                        <div class="col-sm-12 pb-sm">
                            <button class="btn btn-wide btn-default pull-right"
                                    ng-click="backToSummary(true)">
                                <em class="mr-sm"/>{{'dashboard.improveScoreModal.DONE' | translate}}
                            </button>
                        </div>
                    </div>
                </div>

                <div id="run-as-root" ng-if="view===STEP[4]" class="privilege">
                    <div class="header clearfix">
                        <div class="col col-xs-7 description text-muted">
                            {{runAsRoot.description}}
                        </div>
                        <div class="col col-xs-5">
                            <div class="col col-xs-4 score-gauge text-center">
                                <ng-gauge size="100" type="arch" thick="12"
                                          min="0" max="100" value="runAsRoot.currScore.value"
                                          cap="round" label="{{runAsRoot.currScore.text}}" append="" foreground-color="F00"
                                          duration="1" thresholds="securityRiskThresholds" background-color="#EEE">
                                </ng-gauge>
                            </div>
                            <div class="col col-xs-4 text-center pt">
                                <div class="text-muted score-trend-text text-center">{{"dashboard.improveScoreModal.SCORE_TREND" | translate}}</div>
                                <div class="fa fa-long-arrow-right text-primary score-trend text-center" aria-hidden="true">
                                </div>
                            </div>
                            <div class="col col-xs-4 score-gauge text-center">
                                <ng-gauge size="100" type="arch" thick="12"
                                          min="0" max="100" value="runAsRoot.futureScore.value"
                                          cap="round" label="{{runAsRoot.futureScore.text}}" append="" foreground-color="F00"
                                          duration="1" thresholds="securityRiskThresholds" background-color="#EEE">
                                </ng-gauge>
                            </div>
                        </div>
                    </div>
                    <hr class="solid mb mt0"/>
                    <div class="clearfix">
                        <div class="left-inner-addon pull-right" style="margin-bottom: 10px">
                            <em class="fa fa-filter text-filter"/>
                            <input class="search form-control" placeholder="{{'general.FILTER' | translate}}"
                                   type="text"
                                   maxlength="{{'general.FILTER_MAX_LEN' | translate}}"
                                   ng-model="search"
                                   ng-paste="onFilterChanged(search)"
                                   ng-keyup="onFilterChanged(search)"/>
                        </div>
                        <div
                          class="pull-right mr mt-sm"
                          ng-click="exportRunAsRootCsv()"
                          ng-if="hasWorkloads"
                        >
                          <em class="fa fa-download text-action"></em>
                          <label class="text-gray-label hand">
                            {{'general.CSV_DOWNLOAD' | translate}}
                          </label>
                        </div>
                    </div>
                    <div ag-grid="gridOptions" class="ag-grid" style="width: 100%; height: 180px;">
                    </div>
                    <div ng-if="hasWorkloads">
                        <div class="mv-sm"><strong>{{'dashboard.improveScoreModal.DETAILS' | translate}}</strong></div>
                        <div class="container-details">
                            <div class="row m0">
                                <div class="col-xs-6 auto-hide " uib-tooltip="{{workload.id}}" tooltip-enable="false" show-tooltip-on-text-overflow>
                                    <strong>{{'controllers.detail.ID' | translate}}:</strong> {{workload.id}}
                                </div>
                                <div class="col-xs-6 auto-hide " uib-tooltip="{{workload.host_name}}" tooltip-enable="false" show-tooltip-on-text-overflow>
                                    <strong>{{'containers.detail.HOST_NAME' | translate}}:</strong> {{workload.host_name}}
                                </div>
                            </div>
                            <div class="row m0">
                                <div class="col-xs-6 auto-hide " uib-tooltip="{{workload.service}}" tooltip-enable="false" show-tooltip-on-text-overflow>
                                    <strong>{{'network.gridHeader.SERVICE' | translate}}:</strong> {{workload.service}}
                                </div>
                                <div class="col-xs-6 auto-hide " uib-tooltip="{{workload.network_mode}}" tooltip-enable="false" show-tooltip-on-text-overflow>
                                    <strong>{{'containers.detail.NETWORK_MODE' | translate}}:</strong> {{workload.network_mode}}
                                </div>
                            </div>
                            <div class="row m0">
                                <div class="col-xs-6 auto-hide " uib-tooltip="{{workload.image}}" tooltip-enable="false" show-tooltip-on-text-overflow>
                                    <strong>{{'containers.detail.IMAGE' | translate}}:</strong> {{workload.image}}
                                </div>
                                <div class="col-xs-6 auto-hide " uib-tooltip="{{workload.privileged}}" tooltip-enable="false" show-tooltip-on-text-overflow>
                                    <strong>{{'containers.detail.ROOT_PRIVILEGED' | translate}}:</strong> {{workload.privileged}}
                                </div>
                            </div>
                            <div class="row m0">
                                <div class="col-xs-6 auto-hide " uib-tooltip="{{workload.enforcer_name}}" tooltip-enable="false" show-tooltip-on-text-overflow>
                                    <strong>{{'containers.detail.ENFORCER' | translate}}:</strong> {{workload.enforcer_name}}
                                </div>
                                <div class="col-xs-6 auto-hide " ng-if="workload.finished_at" uib-tooltip="{{workload.finished_at | date:'MMM dd, y HH:mm:ss'}}" tooltip-enable="false" show-tooltip-on-text-overflow>
                                    <strong>{{'enforcers.detail.DISCONNECTED_AT' | translate}}:</strong> {{workload.finished_at | date:'MMM dd, y HH:mm:ss'}}
                                </div>
                            </div>
                            <hr class="dashed mv-sm" ng-if="isNotEmptyObj(workload.interfaces) || (workload.ports && workload.ports.length>0)"/>
                            <div ng-if="isNotEmptyObj(workload.interfaces)">
                                <div style="padding-left:15px; padding-right: 15px;">
                                    <strong>{{'containers.detail.NETWORK_INTERFACES' | translate}}</strong>
                                </div>
                                <div class="row" ng-repeat="(name, nets) in workload.interfaces">
                                    <div class="col-sm-2 text-right">
                                        <strong>{{name}}</strong>
                                    </div>
                                    <div class="col-sm-1"></div>
                                    <div class="col-sm-9">
                                        <div ng-repeat="net in nets" class="text-muted">
                                            <div class="col-sm-4">
                                                IP:{{net.ip}}/{{net.ip_prefix}}
                                            </div>
                                            <div class="col-sm-8">
                                                {{"general.GATEWAY" | translate}}:{{net.gateway}}
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div ng-if="workload.ports && workload.ports.length>0">
                                <div style="padding-left:15px; padding-right: 15px;">
                                    <strong>{{'containers.detail.PORT_MAPPING' | translate}}</strong>
                                </div>
                                <div class="row m0" ng-repeat="mapping in workload.ports">
                                    <div class="col-sm-2 text-right">
                                        {{mapping.host_ip}}/{{mapping.host_port}}
                                    </div>
                                    <div class="col-sm-1 text-center">
                                        <em class="fa fa-long-arrow-right text-primary fa-lg"/>
                                    </div>
                                    <div class="col-sm-9 text-muted">
                                        {{mapping.ip_proto === 6 ? 'TCP' : 'UDP'}}/{{mapping.port}}
                                    </div>
                                </div>
                            </div>
                            <div ng-if="isNotEmptyObj(workload.labels)">
                                <div style="padding-left:15px; padding-right: 15px;">
                                    <strong>{{'containers.detail.LABELS' | translate}}</strong>
                                </div>
                                <div class="table-row" ng-repeat="(label, value) in workload.labels">
                                    <div class="row m0">
                                        <div class="col-sm-4 text-right auto-hide"
                                             uib-tooltip="{{label}}" tooltip-enable="false"
                                             show-tooltip-on-text-overflow>
                                            {{label}}
                                        </div>
                                        <div class="col-sm-8 text-muted">
                                            {{value || "&nbsp;"}}
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="bottom-button">
                        <div class="col-sm-12 pb-sm">
                            <button class="btn btn-wide btn-default pull-right"
                                    ng-click="backToSummary(true)">
                                <em class="mr-sm"/>{{'dashboard.improveScoreModal.DONE' | translate}}
                            </button>
                        </div>
                    </div>
                </div>

                <div id="admission" ng-if="view===STEP[5]" class="admission">
                    <div class="header clearfix">
                        <div class="col col-xs-7 description text-muted">
                            {{admission.description}}
                        </div>
                        <div class="col col-xs-5">
                            <div class="col col-xs-4 score-gauge text-center">
                                <ng-gauge size="100" type="arch" thick="12"
                                          min="0" max="100" value="admission.currScore.value"
                                          cap="round" label="{{admission.currScore.text}}" append="" foreground-color="F00"
                                          duration="1" thresholds="securityRiskThresholds" background-color="#EEE">
                                </ng-gauge>
                            </div>
                            <div class="col col-xs-4 text-center pt">
                                <div class="text-muted score-trend-text text-center">{{"dashboard.improveScoreModal.SCORE_TREND" | translate}}</div>
                                <div class="fa fa-long-arrow-right text-primary score-trend text-center" aria-hidden="true">
                                </div>
                            </div>
                            <div class="col col-xs-4 score-gauge text-center">
                                <ng-gauge size="100" type="arch" thick="12"
                                          min="0" max="100" value="admission.futureScore.value"
                                          cap="round" label="{{admission.futureScore.text}}" append="" foreground-color="F00"
                                          duration="1" thresholds="securityRiskThresholds" background-color="#EEE">
                                </ng-gauge>
                            </div>
                        </div>
                    </div>
                    <hr class="solid mb mt0"/>
                    <div class="sample clearfix">
                      <table style="margin: auto;">
                        <tr>
                          <td class="pull-left image sample-1"></td>
                          <td class="fa fa-long-arrow-right text-primary arrow"></td>
                          <td class="pull-right image sample-2"></td>
                        </tr>
                      </table>
                    </div>
                    <div class="bottom-button">
                        <div class="col-sm-12 pb-sm">
                            <button class="btn btn-wide btn-default pull-right"
                                    ng-click="backToSummary(true)">
                                <em class="mr-sm"/>{{'dashboard.improveScoreModal.DONE' | translate}}
                            </button>
                        </div>
                    </div>
                </div>

                <div id="vulnerability" ng-if="view===STEP[6]" class="vulnerability">
                    <div class="header clearfix">
                        <div class="col col-xs-7 description text-muted">
                            {{vulnerability.description}}
                        </div>
                        <div class="col col-xs-5">
                            <div class="col col-xs-4 score-gauge text-center">
                                <ng-gauge size="100" type="arch" thick="12"
                                          min="0" max="100" value="vulnerability.currScore.value"
                                          cap="round" label="{{vulnerability.currScore.text}}" append="" foreground-color="F00"
                                          duration="1" thresholds="securityRiskThresholds" background-color="#EEE">
                                </ng-gauge>
                            </div>
                            <div class="col col-xs-4 text-center pt">
                                <div class="text-muted score-trend-text text-center">{{"dashboard.improveScoreModal.SCORE_TREND" | translate}}</div>
                                <div class="fa fa-long-arrow-right text-primary score-trend text-center" aria-hidden="true">
                                </div>
                            </div>
                            <div class="col col-xs-4 score-gauge text-center">
                                <ng-gauge size="100" type="arch" thick="12"
                                          min="0" max="100" value="vulnerability.futureScore.value"
                                          cap="round" label="{{vulnerability.futureScore.text}}" append="" foreground-color="F00"
                                          duration="1" thresholds="securityRiskThresholds" background-color="#EEE">
                                </ng-gauge>
                            </div>
                        </div>
                    </div>
                    <hr class="solid mb mt0"/>
                    <div class="clearfix">
                        <div ng-repeat="instruction in vulnerability.instructions">
                            <span class="text-muted">{{instruction}}</span>
                        </div>
                    </div>
                    <div class="bottom-button">
                        <div class="col-sm-12 pb-sm">
                            <button class="btn btn-wide btn-default pull-right"
                                    ng-click="backToSummary(true)">
                                <em class="mr-sm"/>{{'dashboard.improveScoreModal.DONE' | translate}}
                            </button>
                        </div>
                    </div>
                </div>
                <div id="conclusion" ng-if="view===STEP[7]" class="conclusion">
                    <div class="clearfix gauge-trend">
                        <div class="col col-xs-4 score-gauge text-center">
                            <ng-gauge size="125" type="arch" thick="12"
                                      min="0" max="125" value="summary.currScore.value"
                                      cap="round" label="{{summary.currScore.text}}" append="" foreground-color="F00"
                                      duration="1" thresholds="securityRiskThresholds" background-color="#EEE">
                            </ng-gauge>
                        </div>
                        <div class="col col-xs-4 text-center pt arrow-wrap">
                            <div class="fa fa-long-arrow-right score-trend text-center arrow" aria-hidden="true" ng-class="{'text-primary': conclusionType===0, 'text-warning': conclusionType===1}"></div>
                        </div>
                        <div class="col col-xs-4 score-gauge text-center">
                            <ng-gauge size="125" type="arch" thick="12"
                                      min="0" max="125" value="summary.fixedScore.value"
                                      cap="round" label="{{summary.fixedScore.text}}" append="" foreground-color="F00"
                                      duration="1" thresholds="securityRiskThresholds" background-color="#EEE">
                            </ng-gauge>
                        </div>
                    </div>
                    <div class="conclusion-text" ng-class="{'text-primary': conclusionType===0, 'text-warning': conclusionType===1}">
                        <div class="title">{{summary.conclusion[conclusionType].title}}</div>
                        <div class="statement" ng-if="summary.currScore.value !== summary.fixedScore.value">{{summary.conclusion[conclusionType].statement}}</div>
                        <div class="statement" ng-if="summary.currScore.value === summary.fixedScore.value">{{summary.noChangeRemind[conclusionType]}}</div>
                    </div>
                </div>
            </div>
        </md-dialog-content>
    </form>
</md-dialog>
